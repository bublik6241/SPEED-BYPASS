local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:FindFirstChild("HumanoidRootPart") -- Главная точка телепорта

local savedPosition = hrp.Position -- Сохраняем начальную позицию

-- Функция для телепортации игрока
local function teleportTo(position)
    if hrp then
        hrp.CFrame = CFrame.new(position)
    end
end

-- Проверка на откат сервера
game:GetService("RunService").Stepped:Connect(function()
    local currentPosition = hrp.Position

    -- Если позиция игрока резко изменилась (откат сервера), вернуть его обратно
    if (currentPosition - savedPosition).Magnitude > 10 then  -- 10 - порог отката
        teleportTo(savedPosition)
    else
        savedPosition = currentPosition -- Обновляем позицию
    end
end)
